syntax = "proto3";
package ipsec;

/* Security Policy Database (SPD */
message SecurityPolicyDatabases {
    message SPD {
        uint32 spd_id = 1;  /* SPD ID */

        message Interface {
            string name = 1;    /* interface name */
        }
        repeated Interface interfaces = 100;    /* list of interfaces belonging to this SPD */
    }
    repeated SPD spds = 1;  /* list of all SPDs */
}

/* Cryptographic algorithm for authentication */
enum IntegAlgorithm {
    NONE = 0;
    MD5_96 = 1;
    SHA1_96 = 2;
    SHA_256_96 = 3;
    SHA_256_128 = 4;
    SHA_384_192 = 5;
    SHA_512_256 = 6;
}

/* Cryptographic algorithm for encryption */
enum CryptoAlgorithm {
    NONE = 0;
    AES_CBC_128 = 1;
    AES_CBC_192 = 2;
    AES_CBC_256 = 3;
}

/* IPSec protocol */
enum IPSecProtocol {
    AH = 0;
    ESP = 1;
}

/* Security Association (SA) */
message SecurityAssociations {
    message SA {
        uint32 id = 1;
        uint32 spi = 2;
        IPSecProtocol protocol = 3;

        CryptoAlgorithm crypto_alg = 4;
        string crypto_key = 6;

        IntegAlgorithm integ_alg = 7;
        string integ_key = 9;

        bool use_esn = 10;          /* Use extended sequence number */
        bool use_anti_replay = 11;  /* Use anti replay */

        bool is_tunnel = 12;
        bool is_tunnel_ipv6 = 13;
        string tunnel_src_addr = 14;
        string tunnel_dst_addr = 15;
    }
    repeated SA sas = 1;
}